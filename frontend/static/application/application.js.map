{"version":3,"sources":["webpack:///webpack/bootstrap bbcd53ff863b69a8d7e5","webpack:///./assets/sass/application.sass","webpack:///./assets/js/application.js","webpack:///./assets/js/main.js","webpack:///./assets/js/templates.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;ACtCA,0C;;;;;;ACAA;;AAEA,wB;;;;;;ACFA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA,IAAG;AACH;AACA;AACA,uGAAsG,kBAAkB;AACxH,IAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,IAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA,mBAAkB,OAAO;AACzB;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA,mBAAkB,sBAAsB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAoB,iBAAiB;AACrC;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAoB,iBAAiB;AACrC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,gBAAe;AACf;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA,cAAa,8BAA8B,qCAAqC;AAChF;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;;AAEA,E;;;;;;ACnOA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA,wCAAuC;AACvC;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,4B","file":"application/application.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"../\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap bbcd53ff863b69a8d7e5\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./assets/sass/application.sass\n ** module id = 1\n ** module chunks = 0\n **/","'use strict';\n\nrequire('./main');\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./assets/js/application.js\n ** module id = 2\n ** module chunks = 0\n **/","'use strict';\n\nvar nodes = nodes || {};\nvar methods = methods || {};\nvar urls = urls || {};\nvar ids = ids || {};\nvar timer;\nvar csrftoken;\n\nvar t = require('./templates');\n\nurls = {\n  images: {\n    start: 'https://api.vk.com/method/photos.get?owner_id=',\n    end: '&album_id=profile&callback=callbackFunc',\n  },\n  casting: '/casting-users/',\n  choices: '/choices/'\n}\n\nnodes.body = $('body');\n\nmethods = {\n  requests: function(url, type, callback, data, obj){\n    if(!url) {\n      console.log('Error: set url');\n      return false;\n    }\n\n    var params = params || {};\n    var support = support || {};\n\n    params = { // default params\n      url: url,\n      type: type || 'get',\n      success: function(data){\n        if(callback) callback(data);\n      }\n    }\n    \n    support = { // support params\n      contentType: \"application/json\",\n      dataType: 'json',\n      headers: {\n        'X-CSRFToken': csrftoken\n      }\n    };\n\n    obj = obj || support;\n\n    for(var prop in obj){\n      params[prop] = obj[prop];\n    }\n\n    if (data) params.data = data;\n\n    // console.log(params)\n\n    $.ajax(params);\n  },\n  getImages: function(){\n    //.choose\n    methods.requests(urls.images.start + ids.vk + urls.images.end, 'get', methods.viewImages, false, {dataType: 'jsonp'});\n  },\n  vote: function(el){\n    var item = el.parents('.vote-item');\n    var check = nodes.body.find('._choose-vote');\n\n    var id = nodes.vote_list.attr('data-vote-id');\n    var uuid = item.attr('data-uuid');\n\n    check.removeClass('_choose-vote');\n    item.toggleClass('_choose-vote');\n\n    methods.requests(urls.choices + id + '/', 'put', methods.reloadVote, '\"' + uuid + '\"');\n  },\n  reloadVote: function(){\n    if(timer) clearTimeout(timer);\n    timer = setTimeout(function(){\n      nodes.vote_list.html('');\n      methods.requests(urls.choices, 'post', methods.viewVote);\n    }, 250)\n    \n  },\n  choose: function(el){\n    var item = el.parents('.choose-item');\n    var check = nodes.body.find('._choose-choose');\n\n    check.removeClass('_choose-choose');\n    item.toggleClass('_choose-choose');\n\n    //ids.vk\n  },\n  viewImages: function(data){\n    var imgs = [];\n    var obj = data.response\n\n    for(var prop in obj){\n      // imgs.push(obj[prop].src)\n      imgs.push((function(){\n        if(obj[prop].src_xxxbig) return obj[prop].src_xxxbig;\n        if(obj[prop].src_xxbig) return obj[prop].src_xxbig;\n        if(obj[prop].src_xbig) return obj[prop].src_xbig;\n        if(obj[prop].src_big) return obj[prop].src_big;\n        if(obj[prop].src) return obj[prop].src;\n      }()));\n    }\n\n    for(var i = 0; i < 4; i++){\n      nodes.choose_list.append( $( t.images(imgs[i]) ) );\n    }\n  },\n  viewVote: function(data){\n    console.log(data);\n    var obj = data;\n    var tmp = {};\n    nodes.vote_list.attr('data-vote-id', obj.id);\n\n    for(var i = 0; i < obj.users.length; i++){\n      // nodes.vote_list.append( $( t.vote() ) );\n      var user = obj.users[i];\n      for(var prop in user){\n        console.log(user);\n        nodes.vote_list.append( $( t.vote(prop, user[prop]) ) );\n      }\n    }\n\n  },\n  viewTop: function(data){\n    var tmp = tmp || {};\n    var id = nodes.body.attr('data-cid');\n    var uid = nodes.body.attr('data-user');\n\n    var getUserInfo = function(obj){\n      var result;\n      for(var i = 0; i < data.length; i++){\n        if(data[i].info.id === obj.user) {\n          result = false;\n          break;\n        } else {\n          result = obj;\n        }\n      }\n      pars(result);\n    };\n\n    var pars = function(obj){\n      for(var i = 0; i < data.length; i++){\n        tmp[i] = data[i];\n      }\n\n      if(obj) {\n        var num = data.length;\n        tmp[num] = obj;\n      }\n\n      view();\n    };\n\n    var view = function(){\n      var count = 0;\n      for(var prop in tmp){\n        nodes.toplist.append( $(t.top(tmp[prop], count, parseInt(uid, 10))) );\n        count++;\n      }\n    }\n\n    methods.requests(urls.casting + id + '/', 'get', getUserInfo);\n  },\n  sendChoose: function(){\n    var item = nodes.body.find('._choose-choose');\n    var img = item.find('img');\n    var src = img.attr('src');\n    var obj = {url: src, user: ids.user};\n    var json = JSON.stringify(obj);\n\n    if(item.length < 1) return false;\n\n    var plzgo = function(){\n      window.open('/votes/','_self')\n    }\n\n    // methods.requests(urls.casting + ids.user + '/', 'post', json, plzgo());\n    methods.requests(urls.casting, 'post', plzgo(), json);\n\n    \n  },\n  eventSets: function(){\n    nodes.body.on({\n      click: function(event){\n        var $target = $( event.target );\n        if($target.hasClass('js-vote-image')) methods.vote($target);\n        if($target.hasClass('js-choose-image')) methods.choose($target);\n        if($target.hasClass('js-choose-send')) methods.sendChoose();\n      }\n    })\n  },\n  csrftoken: function(name) {\n    var matches = document.cookie.match(new RegExp(\n      \"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"\n    ));\n    return matches ? decodeURIComponent(matches[1]) : undefined;\n  },\n  init: function(){\n    csrftoken = methods.csrftoken('csrftoken');\n\n    this.eventSets();\n    nodes.toplist = nodes.body.find('.toplist-list');\n    nodes.choose_list = nodes.body.find('.choose-list');\n    nodes.vote_list = nodes.body.find('.vote-list');\n    nodes.choose = nodes.body.find('.choose');\n\n    ids.vk = nodes.choose.data('vk');\n    ids.user = nodes.choose.data('id');\n\n    if(nodes.choose.length > 0) methods.getImages();\n    if(nodes.vote_list.length > 0) methods.requests(urls.choices, 'post', methods.viewVote);\n    if(nodes.toplist.length > 0) methods.requests(urls.casting + 'top/', 'get', methods.viewTop);\n\n    \n  }\n}\n\nmethods.init();\n\nfunction callbackFunc(result){\n  \n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./assets/js/main.js\n ** module id = 3\n ** module chunks = 0\n **/","'use strict';\n\nvar templates = templates || {};\ntemplates = {\n  images: function(item){\n  var tmp = [];\n  tmp.push('<span class=\"choose-item\"><img class=\"choose-item-image js-choose-image\" src=\"');\n  tmp.push(item);\n  tmp.push('\" /></span>');\n  return tmp.join('');\n  },\n  vote: function(uuid, img){\n  var tmp = [];\n\n  tmp.push('<li class=\"vote-item\" data-uuid=\"');\n  tmp.push(uuid);\n  tmp.push('\"><i class=\"vote-avatar\">');\n  tmp.push('<img src=\"');\n  tmp.push(img);\n  // tmp.push('http://orig01.deviantart.net/9824/f/2016/121/d/7/placeholder_2_by_sketchymouse-da0yiyl.png');\n  tmp.push('\" class=\"vote-avatar-icon js-vote-image\"></img></i></li>');\n\n  return tmp.join('');\n  },\n  top: function(obj, count, id){\n  var tmp = [];\n\n  // console.log(obj);\n\n  if(count === 3) {\n    tmp.push('<li class=\"toplist-item _dotted\">',\n    '<i class=\"toplist-dotted\">&hellip;</i>',\n    '</li>');\n  }\n\n  tmp.push('<li class=\"toplist-item');\n\n  if(count === 0) tmp.push(' _top');\n  if(obj.user === id) tmp.push(' _im');\n\n  tmp.push('\"><i class=\"toplist-num\">');\n\n  if(obj.position) tmp.push(obj.position);\n  else tmp.push(count + 1);\n\n  tmp.push('</i><i class=\"toplist-avatar\"><img src=\"');\n  tmp.push(obj.url);\n  tmp.push('\" class=\"toplist-avatar-img\" /></i>');\n  tmp.push('<span class=\"toplist-info\"><span class=\"toplist-name\">');\n\n  if(obj.info) tmp.push(obj.info.first_name);\n\n  tmp.push('</span><span class=\"toplist-rating\"><i class=\"toplist-rating-icon');\n\n  if(obj.stars > 0) {\n    tmp.push((function(){\n      return ' _' + parseInt(obj.stars, 10)\n    }()));\n  } else {\n    tmp.push(' _1');\n  }\n\n  tmp.push('\"></i><i class=\"toplist-rating-num\">');\n  tmp.push(obj.counter);\n  tmp.push(' голосов</i></span></span></li>');\n\n  return tmp.join('');\n  }\n\n}\n\nmodule.exports = templates;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./assets/js/templates.js\n ** module id = 4\n ** module chunks = 0\n **/"],"sourceRoot":""}