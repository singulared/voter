{"version":3,"sources":["webpack:///webpack/bootstrap 55ab3b1baed787d3828f","webpack:///./assets/sass/application.sass","webpack:///./assets/js/application.js","webpack:///./assets/js/main.js","webpack:///./assets/js/templates.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;ACtCA,0C;;;;;;ACAA;;AAEA,wB;;;;;;ACFA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,IAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAkB,OAAO;AACzB;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA,mBAAkB,sBAAsB;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,qBAAoB,iBAAiB;AACrC;AACA;AACA;;AAEA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,gBAAe;AACf;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA,cAAa,8BAA8B,qCAAqC;AAChF;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA,E;;;;;;ACnMA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,4CAA2C;AAC3C;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,4B","file":"application/application.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"../\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 55ab3b1baed787d3828f\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./assets/sass/application.sass\n ** module id = 1\n ** module chunks = 0\n **/","'use strict';\n\nrequire('./main');\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./assets/js/application.js\n ** module id = 2\n ** module chunks = 0\n **/","'use strict';\n\nvar nodes = nodes || {};\nvar methods = methods || {};\nvar urls = urls || {};\nvar ids = ids || {};\nvar timer;\nvar csrftoken;\n\nvar t = require('./templates');\n\nurls = {\n  images: {\n    start: 'https://api.vk.com/method/photos.get?owner_id=',\n    end: '&album_id=profile&callback=callbackFunc',\n  },\n  casting: '/casting-users/',\n  choices: '/choices/'\n}\n\nnodes.body = $('body');\n\nmethods = {\n  requests: function(url, type, data, callback, el){\n    $.ajax({\n      url: url,\n      data: data,\n      type: type,\n      contentType: \"application/json\",\n      dataType: 'json',\n      headers: {\n        'X-CSRFToken': csrftoken\n      },\n      success: function(data){\n        console.log('data', data);\n        if(callback) callback(data);\n      }\n    })\n  },\n  requests_vk: function(url, type, data, callback, el){\n    $.ajax({\n      url: url,\n      data: data,\n      type: type,\n      dataType: 'jsonp',\n      success: function(data){\n        console.log('data', data);\n        if(callback) callback(data);\n      }\n    })\n  },\n  getImages: function(){\n    //.choose\n    methods.requests_vk(urls.images.start + ids.vk + urls.images.end, 'get', '', methods.viewImages);\n  },\n  vote: function(el){\n    var item = el.parents('.vote-item');\n    var check = nodes.body.find('._choose-vote');\n\n    var id = nodes.vote_list.attr('data-vote-id');\n    var uuid = item.attr('data-uuid');\n\n    check.removeClass('_choose-vote');\n    item.toggleClass('_choose-vote');\n\n    methods.requests(urls.choices + id + '/', 'put', '\"' + uuid + '\"', methods.reloadVote);\n  },\n  reloadVote: function(){\n    if(timer) clearTimeout(timer);\n    timer = setTimeout(function(){\n      nodes.vote_list.html('');\n      methods.requests(urls.choices, 'post', '', methods.viewVote);\n    }, 250)\n    \n  },\n  choose: function(el){\n    var item = el.parents('.choose-item');\n    var check = nodes.body.find('._choose-choose');\n\n    check.removeClass('_choose-choose');\n    item.toggleClass('_choose-choose');\n\n    //ids.vk\n  },\n  viewImages: function(data){\n    var imgs = [];\n    var obj = data.response\n\n    for(var prop in obj){\n      imgs.push(obj[prop].src)\n    }\n\n    for(var i = 0; i < 4; i++){\n      nodes.choose_list.append( $( t.images(imgs[i]) ) );\n    }\n  },\n  viewVote: function(data){\n    var obj = data;\n    var tmp = {};\n    nodes.vote_list.attr('data-vote-id', obj.id);\n\n    for(var i = 0; i < obj.users.length; i++){\n      // nodes.vote_list.append( $( t.vote() ) );\n      var user = obj.users[i];\n      for(var prop in user){\n        nodes.vote_list.append( $( t.vote(prop, user[prop]) ) );\n      }\n    }\n\n  },\n  viewTop: function(data){\n    var tmp = tmp || {};\n    var id = nodes.body.attr('data-user');\n\n    var view = function(){\n      var count = 0;\n      for(var prop in tmp){\n        nodes.toplist.append( $(t.top(tmp[prop], count, id)) );\n        count++;\n      }\n    }\n\n    var diff = function(obj){\n      tmp[obj.rating] = obj;\n      pars(data);\n    };\n\n    var pars = function(data){\n      for(var i = 0; i < data.length; i++){\n        // nodes.toplist.append( $(t.top(data[i], i)) );\n        tmp[data[i].rating] = data[i];\n      }\n\n      view();\n    };\n\n    methods.requests(urls.casting + id + '/', 'get', '', diff);\n  },\n  sendChoose: function(){\n    var item = nodes.body.find('._choose-choose');\n    var img = item.find('img');\n    var src = img.attr('src');\n    var obj = {url: src};\n    var json = JSON.stringify(obj);\n\n    if(item.length < 1) return false;\n\n    var plzgo = function(){\n      window.open(\"/votes/\",\"_self\")\n    }\n\n    methods.requests(urls.casting + ids.user + '/', 'patch', json, plzgo());\n\n    \n  },\n  eventSets: function(){\n    nodes.body.on({\n      click: function(event){\n        var $target = $( event.target );\n        if($target.hasClass('js-vote-image')) methods.vote($target);\n        if($target.hasClass('js-choose-image')) methods.choose($target);\n        if($target.hasClass('js-choose-send')) methods.sendChoose();\n      }\n    })\n  },\n  csrftoken: function(name) {\n    var matches = document.cookie.match(new RegExp(\n      \"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"\n    ));\n    return matches ? decodeURIComponent(matches[1]) : undefined;\n  },\n  init: function(){\n    csrftoken = methods.csrftoken('csrftoken');\n\n    this.eventSets();\n    nodes.toplist = nodes.body.find('.toplist-list');\n    nodes.choose_list = nodes.body.find('.choose-list');\n    nodes.vote_list = nodes.body.find('.vote-list');\n    nodes.choose = nodes.body.find('.choose');\n\n    ids.vk = nodes.choose.data('vk');\n    ids.user = nodes.choose.data('id');\n\n    if(nodes.choose.length > 0) methods.getImages();\n    if(nodes.vote_list.length > 0) methods.requests(urls.choices, 'post', '', methods.viewVote);\n    if(nodes.toplist.length > 0) methods.requests(urls.casting + 'top/', 'get', '', methods.viewTop);\n\n    \n  }\n}\n\nmethods.init();\n\nfunction callbackFunc(result){\n  console.log(result);\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./assets/js/main.js\n ** module id = 3\n ** module chunks = 0\n **/","'use strict';\n\nvar templates = templates || {};\ntemplates = {\n  images: function(item){\n    var tmp = [];\n    tmp.push('<span class=\"choose-item\"><img class=\"choose-item-image js-choose-image\" src=\"');\n    tmp.push(item);\n    tmp.push('\" /></span>');\n    return tmp.join('');\n  },\n  vote: function(uuid, img){\n    var tmp = [];\n\n    tmp.push('<li class=\"vote-item\" data-uuid=\"');\n    tmp.push(uuid);\n    tmp.push('\"><i class=\"vote-avatar\">');\n    tmp.push('<img src=\"');\n    tmp.push(img);\n    // tmp.push('http://orig01.deviantart.net/9824/f/2016/121/d/7/placeholder_2_by_sketchymouse-da0yiyl.png');\n    tmp.push('\" class=\"vote-avatar-icon js-vote-image\"></img></i></li>');\n\n    return tmp.join('');\n  },\n  top: function(obj, count, id){\n    var tmp = []\n\n    console.log(count)\n    if(count === 2) {\n      tmp.push('<li class=\"toplist-item _dotted\">',\n        '<i class=\"toplist-dotted\">&hellip;</i>',\n        '</li>');\n      return false;\n    }\n\n    tmp.push('<li class=\"toplist-item');\n\n    if(count === 0) tmp.push(' _top');\n    if(obj.id === id) tmp.push(' _im');\n\n    tmp.push('\"><i class=\"toplist-num\">');\n\n    if(obj.position) tmp.push(obj.position);\n    else tmp.push(count + 1);\n\n    tmp.push('</i><i class=\"toplist-avatar\"><img src=\"');\n    tmp.push(obj.url);\n    tmp.push('\" class=\"toplist-avatar-img\" /></i>');\n    tmp.push('<span class=\"toplist-info\"><span class=\"toplist-name\">');\n    tmp.push(obj.info.first_name);\n    tmp.push('</span><span class=\"toplist-rating\"><i class=\"toplist-rating-icon');\n\n    if(obj.stars > 0) tmp.push((function(){\n      return ' _' + parseInt(obj.stars, 10)\n    }()));\n\n    tmp.push('\"></i><i class=\"toplist-rating-num\">');\n    tmp.push(obj.counter);\n    tmp.push(' голосов</i></span></span></li>');\n\n    return tmp.join('');\n  }\n\n}\n\nmodule.exports = templates;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./assets/js/templates.js\n ** module id = 4\n ** module chunks = 0\n **/"],"sourceRoot":""}